@using Helpio.Dashboard.Services
@inject ICurrentUserContext UserContext

<!--begin::Sidebar-->
<aside class="app-sidebar bg-body-secondary shadow" data-bs-theme="dark">
  <!--begin::Sidebar Brand-->
  <div class="sidebar-brand">
    <!--begin::Brand Link-->
    <a asp-controller="Dashboard" asp-action="Index" class="brand-link">
      <!--begin::Brand Image-->
      <img
        src="~/assets/img/AdminLTELogo.png"
        alt="Helpio Logo"
        class="brand-image opacity-75 shadow"
      />
      <!--end::Brand Image-->
      <!--begin::Brand Text-->
      <span class="brand-text fw-light">Helpio Dashboard</span>
      <!--end::Brand Text-->
    </a>
    <!--end::Brand Link-->
  </div>
  <!--end::Sidebar Brand-->
  
  <!--begin::Organization Info-->
  @if (User.Identity?.IsAuthenticated == true && UserContext.CurrentOrganization != null)
  {
    <div class="organization-info text-center py-2 bg-dark border-bottom border-secondary">
      <small class="text-light">
        <i class="bi bi-building text-warning"></i>
        <strong>@UserContext.CurrentOrganization.Name</strong>
        @if (UserContext.CurrentTeam != null)
        {
          <span class="mx-2 text-muted">|</span>
          <i class="bi bi-people text-info"></i>
          <span class="text-info">@UserContext.CurrentTeam.Name</span>
        }
        @if (UserContext.UserRoles.Any())
        {
          <span class="mx-2 text-muted">|</span>
          <i class="bi bi-person-badge text-success"></i>
          <span class="text-success">@string.Join(", ", UserContext.UserRoles)</span>
        }
      </small>
    </div>
  }
  <!--end::Organization Info-->
  
  <!--begin::Sidebar Wrapper-->
  <div class="sidebar-wrapper">
    <nav class="mt-2">
      <!--begin::Sidebar Menu-->
      <ul class="nav sidebar-menu flex-column" data-lte-toggle="treeview" role="navigation" aria-label="Main navigation" data-accordion="false">
        
        <!-- Dashboard -->
        <li class="nav-item">
          <a asp-controller="Dashboard" asp-action="Index" class="nav-link">
            <i class="nav-icon bi bi-speedometer"></i>
            <p>داشبورد</p>
          </a>
        </li>

        <!-- Tickets Section -->
        <li class="nav-item">
          <a href="#" class="nav-link">
            <i class="nav-icon bi bi-ticket-detailed"></i>
            <p>
              مدیریت تیکت‌ها
              <i class="nav-arrow bi bi-chevron-right"></i>
            </p>
          </a>
          <ul class="nav nav-treeview">
            <li class="nav-item">
              <a asp-controller="Tickets" asp-action="Index" class="nav-link">
                <i class="nav-icon bi bi-circle"></i>
                <p>لیست تیکت‌ها</p>
              </a>
            </li>
            @if (UserContext.IsAdmin || UserContext.IsManager)
            {
              <li class="nav-item">
                <a asp-controller="Tickets" asp-action="Create" class="nav-link">
                  <i class="nav-icon bi bi-circle"></i>
                  <p>ایجاد تیکت جدید</p>
                </a>
              </li>
            }
          </ul>
        </li>

        <!-- Customers Section -->
        <li class="nav-item">
          <a href="#" class="nav-link">
            <i class="nav-icon bi bi-people"></i>
            <p>
              مدیریت مشتریان
              <i class="nav-arrow bi bi-chevron-right"></i>
            </p>
          </a>
          <ul class="nav nav-treeview">
            <li class="nav-item">
              <a asp-controller="Customers" asp-action="Index" class="nav-link">
                <i class="nav-icon bi bi-circle"></i>
                <p>لیست مشتریان</p>
              </a>
            </li>
            @if (UserContext.IsAdmin || UserContext.IsManager)
            {
              <li class="nav-item">
                <a asp-controller="Customers" asp-action="Create" class="nav-link">
                  <i class="nav-icon bi bi-circle"></i>
                  <p>افزودن مشتری</p>
                </a>
              </li>
            }
          </ul>
        </li>

        <!-- Teams Section -->
        <li class="nav-item">
          <a href="#" class="nav-link">
            <i class="nav-icon bi bi-people-fill"></i>
            <p>
              مدیریت تیم‌ها
              <i class="nav-arrow bi bi-chevron-right"></i>
            </p>
          </a>
          <ul class="nav nav-treeview">
            <li class="nav-item">
              <a asp-controller="Teams" asp-action="Index" class="nav-link">
                <i class="nav-icon bi bi-circle"></i>
                <p>لیست تیم‌ها</p>
              </a>
            </li>
            @if (UserContext.IsAdmin || UserContext.IsManager)
            {
              <li class="nav-item">
                <a asp-controller="Teams" asp-action="Create" class="nav-link">
                  <i class="nav-icon bi bi-circle"></i>
                  <p>ایجاد تیم جدید</p>
                </a>
              </li>
            }
          </ul>
        </li>

        <!-- Support Agents Section -->
        <li class="nav-item">
          <a href="#" class="nav-link">
            <i class="nav-icon bi bi-person-badge"></i>
            <p>
              مدیریت کارشناسان
              <i class="nav-arrow bi bi-chevron-right"></i>
            </p>
          </a>
          <ul class="nav nav-treeview">
            <li class="nav-item">
              <a asp-controller="SupportAgents" asp-action="Index" class="nav-link">
                <i class="nav-icon bi bi-circle"></i>
                <p>لیست کارشناسان</p>
              </a>
            </li>
            @if (UserContext.IsAdmin || UserContext.IsManager)
            {
              <li class="nav-item">
                <a asp-controller="SupportAgents" asp-action="Create" class="nav-link">
                  <i class="nav-icon bi bi-circle"></i>
                  <p>افزودن کارشناس</p>
                </a>
              </li>
            }
          </ul>
        </li>

        <!-- Organizations Section - Admin Only -->
        @if (UserContext.IsAdmin)
        {
          <li class="nav-item">
            <a href="#" class="nav-link">
              <i class="nav-icon bi bi-building"></i>
              <p>
                مدیریت سازمان‌ها
                <i class="nav-arrow bi bi-chevron-right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              <li class="nav-item">
                <a asp-controller="Organizations" asp-action="Index" class="nav-link">
                  <i class="nav-icon bi bi-circle"></i>
                  <p>لیست سازمان‌ها</p>
                </a>
              </li>
              <li class="nav-item">
                <a asp-controller="Organizations" asp-action="Create" class="nav-link">
                  <i class="nav-icon bi bi-circle"></i>
                  <p>افزودن سازمان</p>
                </a>
              </li>
            </ul>
          </li>
        }

        <!-- Knowledge Base -->
        <li class="nav-item">
          <a href="#" class="nav-link">
            <i class="nav-icon bi bi-journal-bookmark"></i>
            <p>
              پایگاه دانش
              <i class="nav-arrow bi bi-chevron-right"></i>
            </p>
          </a>
          <ul class="nav nav-treeview">
            <li class="nav-item">
              <a asp-controller="Knowledge" asp-action="Articles" class="nav-link">
                <i class="nav-icon bi bi-circle"></i>
                <p>مقالات</p>
              </a>
            </li>
            <li class="nav-item">
              <a asp-controller="Knowledge" asp-action="CannedResponses" class="nav-link">
                <i class="nav-icon bi bi-circle"></i>
                <p>پاسخ‌های آماده</p>
              </a>
            </li>
            @if (UserContext.IsAdmin || UserContext.IsManager)
            {
              <li class="nav-item">
                <a asp-controller="Knowledge" asp-action="CreateArticle" class="nav-link">
                  <i class="nav-icon bi bi-circle"></i>
                  <p>ایجاد مقاله</p>
                </a>
              </li>
              <li class="nav-item">
                <a asp-controller="Knowledge" asp-action="CreateCannedResponse" class="nav-link">
                  <i class="nav-icon bi bi-circle"></i>
                  <p>ایجاد پاسخ آماده</p>
                </a>
              </li>
            }
          </ul>
        </li>

        <!-- Reports Section -->
        <li class="nav-item">
          <a href="#" class="nav-link">
            <i class="nav-icon bi bi-bar-chart"></i>
            <p>
              گزارشات
              <i class="nav-arrow bi bi-chevron-right"></i>
            </p>
          </a>
          <ul class="nav nav-treeview">
            <li class="nav-item">
              <a asp-controller="Reports" asp-action="Index" class="nav-link">
                <i class="nav-icon bi bi-circle"></i>
                <p>گزارش کلی</p>
              </a>
            </li>
            <li class="nav-item">
              <a asp-controller="Reports" asp-action="TicketReport" class="nav-link">
                <i class="nav-icon bi bi-circle"></i>
                <p>گزارش تیکت‌ها</p>
              </a>
            </li>
            @if (UserContext.IsAdmin || UserContext.IsManager)
            {
              <li class="nav-item">
                <a asp-controller="Reports" asp-action="AgentPerformance" class="nav-link">
                  <i class="nav-icon bi bi-circle"></i>
                  <p>عملکرد کارشناسان</p>
                </a>
              </li>
            }
          </ul>
        </li>

        <!-- User Profile -->
        <li class="nav-header">کاربر</li>
        <li class="nav-item">
          <a asp-controller="Profile" asp-action="Index" class="nav-link">
            <i class="nav-icon bi bi-person-circle"></i>
            <p>پروفایل من</p>
          </a>
        </li>

        <!-- Settings Section - Admin/Manager Only -->
        @if (UserContext.IsAdmin || UserContext.IsManager)
        {
          <li class="nav-header">تنظیمات</li>
          <li class="nav-item">
            <a href="#" class="nav-link">
              <i class="nav-icon bi bi-gear-fill"></i>
              <p>
                تنظیمات سیستم
                <i class="nav-arrow bi bi-chevron-right"></i>
              </p>
            </a>
            <ul class="nav nav-treeview">
              @if (UserContext.IsAdmin)
              {
                <li class="nav-item">
                  <a href="#" class="nav-link">
                    <i class="nav-icon bi bi-circle"></i>
                    <p>تنظیمات عمومی</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="#" class="nav-link">
                    <i class="nav-icon bi bi-circle"></i>
                    <p>تنظیمات امنیتی</p>
                  </a>
                </li>
              }
              <li class="nav-item">
                <a asp-controller="Profile" asp-action="Edit" class="nav-link">
                  <i class="nav-icon bi bi-circle"></i>
                  <p>ویرایش پروفایل</p>
                </a>
              </li>
            </ul>
          </li>
        }

        <!-- Help Section -->
        <li class="nav-header">راهنما</li>
        <li class="nav-item">
          <a href="#" class="nav-link">
            <i class="nav-icon bi bi-question-circle"></i>
            <p>راهنمای استفاده</p>
          </a>
        </li>
        <li class="nav-item">
          <a href="#" class="nav-link">
            <i class="nav-icon bi bi-telephone"></i>
            <p>تماس با پشتیبانی</p>
          </a>
        </li>
        
      </ul>
      <!--end::Sidebar Menu-->
    </nav>
  </div>
  <!--end::Sidebar Wrapper-->
</aside>
<!--end::Sidebar-->